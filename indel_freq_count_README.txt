Indel Frequency Counting Script:

This awk script takes the output of "indel_parse_whole.awk" and tabulates the wild-type and indel events that occurred.  The fraction of reads that were legitimate CRISPR editing events are computed as well.


Script Explanation:


The awk script first reads through each line and tabulates the number of legitimate indel events and wild-type sequence events that occurred for each gene.  The "gwt" and "gid" variables store the number of gene wild type and gene indel events in a vector, respectively.  

**********************************
if (!($5 in gwt) && !($5 in gid)){
	gwt[$5]=0
	gid[$5]=0
	rtype[$5]=$(NF-1)
}
**********************************

NOTE: field 5 refers to the gene name within the input bed file.  Change this field accordingly if this information is in a different field.  

NOTE: For our data analysis, we had a field labelling whether or not a site was Intronic or Exonic.  This is being stored by the "rtype" variable.  If you do not have this information, feel free to delete this variable.


Next, the last field indicating whether or not a gene's read was a legitimate CRISPR indel or not is processed as shown below:

***************************
if ($NF~/WT/){
	gwt[$5]=(gwt[$5]+1)
}
else if ($NF~/INDEL/){
	gid[$5]=(gid[$5]+1)
}
***************************

Once at the end of the file, the results are printed in the following format:

gene_name locus_type number_of_indels number_of_wt frac_indel

This is generated by the following for loop:

for (g in gwt){
	OFS="\t"
	print g,rtype[g],gid[g],(gid[g]+gwt[g]),((gid[g])/(gid[g]+gwt[g]))
}

NOTE: locus_type again refers to whether or not a particular site was Intronic or Exonic.  If you do not have this information, delete "rtype[g]" from the print statement.


The script should be called like this: 
(On_target_reads_true.bed is generated from indel_parse_whole.awk.  Refer to the "indel_parse_whole_README.txt" for information on how to generate this file.)

awk -f indel_freq_count.awk < On_target_reads_true.bed > Indel_Table.txt










